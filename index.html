<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>LA MAYORISTA EXPRESS</title>
<meta name="theme-color" content="#ff5722">
<meta name="description" content="LA MAYORISTA EXPRESS - Marketplace mayorista en Cuba">
<link rel="manifest" href='data:application/json,{
  "name":"LA MAYORISTA EXPRESS",
  "short_name":"MAYORISTA",
  "start_url":".",
  "display":"standalone",
  "background_color":"#ffffff",
  "theme_color":"#ff5722",
  "icons":[{"src":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAB","sizes":"192x192","type":"image/png"}]
}'>
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto}
body{background:#f5f5f5;color:#222}
header{position:fixed;top:0;left:0;right:0;background:#ff5722;color:#fff;z-index:1000;padding:10px}
header h1{font-size:18px;text-align:center}
.top-controls{display:flex;gap:6px;margin-top:6px}
.top-controls input{flex:1;padding:8px;border-radius:20px;border:none}
.top-controls select,.cart-btn{padding:8px;border-radius:20px;border:none}
.cart-btn{background:#fff;color:#ff5722;font-weight:bold}
.marquee{margin-top:6px;overflow:hidden;white-space:nowrap}
.marquee span{display:inline-block;padding-left:100%;animation:mar 15s linear infinite}
@keyframes mar{0%{transform:translateX(0)}100%{transform:translateX(-100%)}}
main{padding-top:130px;padding-bottom:40px}
.products{display:grid;grid-template-columns:1fr;gap:12px;padding:12px}
.card{background:#fff;border-radius:16px;padding:12px;box-shadow:0 2px 8px rgba(0,0,0,.1);transition:.2s}
.card h3{font-size:16px}
.price{font-weight:bold;color:#ff5722}
.controls{display:flex;justify-content:space-between;align-items:center;margin-top:8px}
.controls button{width:32px;height:32px;border:none;border-radius:50%;background:#ff5722;color:#fff;font-size:18px}
.drawer{position:fixed;top:0;left:-100%;width:100%;height:100%;background:#fff;z-index:2000;transition:.3s;padding:12px;overflow:auto}
.drawer.open{left:0}
.drawer h2{text-align:center;margin-bottom:10px}
.drawer-item{display:flex;justify-content:space-between;margin:6px 0}
.total{font-size:18px;font-weight:bold;margin-top:10px}
.form-group{margin:8px 0}
.form-group input,.form-group select{width:100%;padding:8px;border-radius:8px;border:1px solid #ccc}
.invoice{background:#f9f9f9;padding:10px;border-radius:8px;margin-top:10px;display:none}
.invoice.show{display:block}
.announce{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:#ff5722;color:#fff;padding:10px 16px;border-radius:20px;display:none;z-index:3000}
</style>
</head>
<body>

<header>
  <h1>LA MAYORISTA EXPRESS</h1>
  <div class="top-controls">
    <input id="search" placeholder="Buscar productos...">
    <select id="currency">
      <option value="CUP">CUP</option>
      <option value="USD">USD</option>
      <option value="MLC">MLC</option>
      <option value="TC">Tarjeta ClÃ¡sica</option>
      <option value="CRYPTO">Criptomoneda</option>
    </select>
    <button class="cart-btn" onclick="toggleCart()">ðŸ›’ <span id="cartTotal">0</span></button>
  </div>
  <div class="marquee"><span>ðŸ”¥ Ofertas mayoristas â€¢ ðŸšš EnvÃ­os rÃ¡pidos â€¢ ðŸ’° Precios reales de mercado â€¢ ðŸ›’ Compra segura</span></div>
</header>

<main>
  <div class="products" id="products"></div>
</main>

<div class="drawer" id="cart">
  <h2>Carrito</h2>
  <div id="cartItems"></div>
  <div class="total" id="cartSum"></div>
  <button onclick="clearCart()">Vaciar carrito</button>

  <h3>Datos del cliente</h3>
  <div class="form-group"><input id="name" placeholder="Nombre completo"></div>
  <div class="form-group"><input id="phone" placeholder="TelÃ©fono"></div>
  <div class="form-group"><input id="address" placeholder="DirecciÃ³n"></div>
  <div class="form-group">
    <select id="pay">
      <option>Efectivo</option>
      <option>Transferencia</option>
      <option>MLC</option>
      <option>Cripto</option>
    </select>
  </div>
  <div class="form-group">
    <select id="delivery">
      <option>MensajerÃ­a</option>
      <option>Recoger en tienda</option>
    </select>
  </div>

  <button onclick="toggleInvoice()">Ver / Ocultar factura</button>
  <div class="invoice" id="invoice"></div>

  <button onclick="sendWhatsApp()">Enviar por WhatsApp</button>
  <button onclick="toggleCart()">Cerrar</button>
</div>

<div class="announce" id="announce"></div>

<script>
const rates={USD:495,MLC:410,TC:410,CRYPTO:495,CUP:1};
const products=[
["ðŸš Saco de Arroz (100 lb)","saco",13600],
["ðŸ«˜ Frijol negro","lb",224],
["ðŸ«˜ Frijol colorado","lb",240],
["ðŸ¬ AzÃºcar","lb",184],
["ðŸŒ½ Harina de maÃ­z","lb",120],
["ðŸŒ½ MaÃ­z en grano","lb",112],
["ðŸ Espagueti 500g","unidad",224],
["ðŸ— Pollo","lb",256],
["ðŸ– Carne de cerdo","lb",520],
["ðŸ¥© Picadillo","lb",320],
["ðŸ¥š CartÃ³n de huevos (30)","cartÃ³n",2240],
["ðŸ¥› Leche en polvo","kg",2800],
["ðŸ§€ Queso blanco","lb",2240],
["ðŸ›¢ï¸ Aceite","litro",560],
["ðŸ§º Detergente polvo","kg",560],
["ðŸ§´ Detergente lÃ­quido","litro",600],
["ðŸ§¼ JabÃ³n de baÃ±o","unidad",200],
["ðŸ§» Papel higiÃ©nico","paquete",704],
["ðŸ§… Cebolla","lb",240],
["ðŸ… Tomate","lb",160],
["ðŸ¥” Papa","lb",160],
["ðŸŒ PlÃ¡tano vianda","lb",96],
["ðŸž Pan","unidad",120],
["ðŸš Arroz congrÃ­ preparado","kg",400],
["ðŸ¥« Pasta de tomate","unidad",280],
["ðŸ§‚ Sal","lb",80],
["ðŸ§ˆ Margarina","unidad",320],
["ðŸ¯ Miel","unidad",600],
["ðŸ¥• Zanahoria","lb",160],
["ðŸ¥¬ Col","lb",144],
["ðŸ PiÃ±a","unidad",400],
["ðŸ‰ MelÃ³n","unidad",480],
["ðŸŠ Naranja","lb",96],
["ðŸ‹ LimÃ³n","lb",120],
["ðŸ§ƒ Refresco","unidad",200],
["ðŸ¥¤ Jugo","unidad",240],
["ðŸ§½ Esponja","unidad",120],
["ðŸª£ Cubo plÃ¡stico","unidad",600],
["ðŸ§´ Cloro","litro",200],
["ðŸ§¼ Suavizante","litro",480],
["ðŸ§º JabÃ³n lavar","lb",240],
["ðŸ– Costilla cerdo","lb",560],
["ðŸ„ Carne res","lb",960],
["ðŸ¥“ Tocino","lb",640],
["ðŸ— Muslo pollo","lb",280],
["ðŸ¥« Sardinas","unidad",320],
["ðŸ¥« AtÃºn","unidad",560],
["ðŸª Galletas","paquete",200],
["ðŸ« Chocolate","unidad",320],
["ðŸ§‚ Condimento mixto","unidad",160],
["ðŸš Harina trigo","lb",160],
["ðŸ¥› Leche lÃ­quida","litro",240],
["ðŸ§¼ Shampoo","unidad",600],
["ðŸª¥ Pasta dental","unidad",320],
["ðŸ§´ Alcohol","litro",400]
];
let cart=JSON.parse(localStorage.getItem("cart")||"{}");
let currency=localStorage.getItem("currency")||"CUP";

document.getElementById("currency").value=currency;

function render(){
  const list=document.getElementById("products");
  list.innerHTML="";
  products.forEach((p,i)=>{
    if(document.getElementById("search").value && !p[0].toLowerCase().includes(document.getElementById("search").value.toLowerCase()))return;
    const qty=cart[i]||0;
    const div=document.createElement("div");
    div.className="card";
    div.innerHTML=`<h3>${p[0]}</h3><div>${p[1]}</div>
    <div class="price">${convert(p[2])}</div>
    <div class="controls">
      <button onclick="add(${i},-1)">âž–</button>
      <span>${qty}</span>
      <button onclick="add(${i},1)">âž•</button>
    </div>`;
    list.appendChild(div);
  });
  updateCart();
}
function convert(v){
  if(currency==="CUP")return v+" CUP";
  return (v/rates[currency]).toFixed(2)+" "+currency;
}
function add(i,d){
  cart[i]=(cart[i]||0)+d;
  if(cart[i]<0)cart[i]=0;
  save();
}
function save(){
  localStorage.setItem("cart",JSON.stringify(cart));
  localStorage.setItem("currency",currency);
  render();
}
function updateCart(){
  let sum=0;
  let items="";
  Object.keys(cart).forEach(i=>{
    if(cart[i]>0){
      const p=products[i];
      const sub=p[2]*cart[i];
      sum+=sub;
      items+=`<div class="drawer-item">${p[0]} x${cart[i]} <span>${convert(sub)}</span></div>`;
    }
  });
  document.getElementById("cartItems").innerHTML=items;
  document.getElementById("cartSum").innerText="Total: "+convert(sum);
  document.getElementById("cartTotal").innerText=convert(sum);
  document.getElementById("invoice").innerText=items+"\nTotal: "+convert(sum);
}
function toggleCart(){document.getElementById("cart").classList.toggle("open")}
function clearCart(){cart={};save()}
function toggleInvoice(){document.getElementById("invoice").classList.toggle("show")}
function sendWhatsApp(){
  const text=encodeURIComponent(document.getElementById("invoice").innerText);
  window.open("https://wa.me/53420021?text="+text,"_blank");
}
document.getElementById("currency").onchange=e=>{currency=e.target.value;save()}
document.getElementById("search").oninput=render;

setInterval(()=>{
  const a=document.getElementById("announce");
  a.innerText=["ðŸ”¥ Oferta especial","ðŸšš EnvÃ­os rÃ¡pidos","ðŸ’° Precios mayoristas"][Math.floor(Math.random()*3)];
  a.style.display="block";
  setTimeout(()=>a.style.display="none",3000);
},[20000,30000,60000][Math.floor(Math.random()*3)]);

render();

if("serviceWorker"in navigator){
  const sw=`
  self.addEventListener('install',e=>self.skipWaiting());
  self.addEventListener('fetch',e=>{});
  `;
  navigator.serviceWorker.register(URL.createObjectURL(new Blob([sw],{type:"text/javascript"})));
}
</script>
</body>
  </html>
